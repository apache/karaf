// 
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
// 
//      http://www.apache.org/licenses/LICENSE-2.0
// 
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
// 

= Using the karaf-maven-plugin

The Karaf Maven plugin allows you:

    * to work with Karaf features: validate a features descriptor, add features bundle into a repository, create a KAR archive from a features descriptor, etc.
    * to create Karaf commands help: it generates help from Karaf commands
    * to modify Karaf instances and create distributions

== Packagings
The most generally useful features of the karaf-maven-plugin are exposed as packagings.  To use the packagings the pom or an ancestor must configure the karaf-maven-plugin with extensions:

----
    <build>
        <pluginManagement>
            <plugins>
                <plugin>
                    <groupId>org.apache.karaf.tooling</groupId>
                    <artifactId>karaf-maven-plugin</artifactId>
                    <version>${project.version}</version>
                    <extensions>true</extensions>
                </plugin>
            </plugins>
        </pluginManagement>
        <plugins>
            <plugin>
                <groupId>org.apache.karaf.tooling</groupId>
                <artifactId>karaf-maven-plugin</artifactId>
            </plugin>
        </plugins>
    </build>
----

Then specify the packaging in your project as usual, e.g.

----
    <packaging>kar</packaging>
----

[cols="1,5"]
|===
|Packaging | Description
| feature | The feature packaging generates a features.xml descriptor using the _karaf:features-generate-descriptor\|karaf-maven-plugin-features-generate-descriptor_ 
| kar | The kar packaging generates a features.xml descriptor using the _karaf:features-generate-descriptor\|karaf-maven-plugin-features-generate-descriptor_ and then packages a kar using the _karaf:features-create-kar\|karaf-maven-plugin-features-create-kar_ 
| _karaf-assembly\|custom-distribution_ | Assembles a Karaf server based on the features descriptors and kar files listed as Maven dependencies. 
|===

== Commands goals

The _karaf-maven-plugin_ is able to generate documentation for Karaf commands:

|===
| Goal | Description 
| _karaf:commands-generate-help\|karaf-maven-plugin-commands-generate-help_ | Generates help for Karaf commands. 
|===

== Features goals

Normally you should use the features or kar packagings instead of these individual goals.
The _karaf-maven-plugin_ provides several goals to help you create and validate features XML descriptors as well as leverage your features to create a custom Karaf distribution.

|===
| Goal | Description
| _karaf:features-generate-descriptor\|karaf-maven-plugin-features-generate-descriptor_ | Generates a features XML descriptor for a set of bundles.  Used in feature and kar packagings. 
| _karaf:features-validate-descriptor\|karaf-maven-plugin-features-validate-descriptor_ | Validate a features XML descriptor by checking if all the required imports can be matched to exports 
| _karaf:kar\|karaf-maven-plugin-features-create-kar_ | Assemble a KAR archive from a features XML descriptor. Used in kar packaging.
|===


== Instances and distributions goals

Normally you should use the karaf-assembly packaging instead of this individual goal.
The _karaf-maven-plugin_ helps you to build custom Karaf distributions or archives existing Karaf instances:

|===
| Goal | Descriptio
| _karaf:assembly_ | Assemble a server from Maven feature-repo and kar dependencies. Used in karaf-assembly packaging.  See _karaf-assembly\|custom-distribution_. 
| _karaf:archive\|karaf-maven-plugin-instance-create-archive_ | Package a server archive from an assembled server. . Used in karaf-assembly packaging.  See also _karaf-assembly\|custom-distribution_.
| _karaf:features-add-to-repository\|karaf-maven-plugin-features-add-to-repository_ | (old style manual assemblies) Copies all the bundles required for a given set of features into a directory \\ (e.g. for creating your own Karaf-based distribution) 
|===
